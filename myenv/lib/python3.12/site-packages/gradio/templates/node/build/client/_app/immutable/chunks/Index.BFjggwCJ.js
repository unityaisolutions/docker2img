import{SvelteComponent as ye,init as Ee,safe_not_equal as we,element as k,space as z,text as A,claim_element as g,children as C,detach as p,claim_space as L,get_svelte_dataset as se,claim_text as O,attr as b,toggle_class as W,set_style as ne,insert_hydration as U,append_hydration as m,set_input_value as oe,listen as R,group_outros as _e,transition_out as X,check_outros as me,transition_in as F,run_all as je,onMount as Ce,tick as te,set_data as pe,binding_callbacks as le,bind as Te,create_component as ve,claim_component as be,mount_component as ke,add_flush_callback as Be,destroy_component as ge,ensure_array_like as re,destroy_each as De}from"../../../svelte/svelte.js";import"../../../svelte/svelte-submodules.js";import"./2.BPKDF4Xe.js";import{C as Ie}from"./Code.BL1_HwKa.js";/* empty css                                              */import{M as Ue}from"./Index.svelte_svelte_type_style_lang.Ck5CJfC9.js";/* empty css                                              */function ie(o,e,t){const l=o.slice();return l[28]=e[t],l[30]=t,l}function ae(o){let e,t,l=o[6].lines_added>0&&ue(o),n=o[6].lines_removed>0&&ce(o);return{c(){e=k("span"),l&&l.c(),t=z(),n&&n.c(),this.h()},l(s){e=g(s,"SPAN",{class:!0});var a=C(e);l&&l.l(a),t=L(a),n&&n.l(a),a.forEach(p),this.h()},h(){b(e,"class","diff-stats svelte-tkeujr")},m(s,a){U(s,e,a),l&&l.m(e,null),m(e,t),n&&n.m(e,null)},p(s,a){s[6].lines_added>0?l?l.p(s,a):(l=ue(s),l.c(),l.m(e,t)):l&&(l.d(1),l=null),s[6].lines_removed>0?n?n.p(s,a):(n=ce(s),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(s){s&&p(e),l&&l.d(),n&&n.d()}}}function ue(o){let e,t,l=o[6].lines_added+"",n;return{c(){e=k("span"),t=A("+"),n=A(l),this.h()},l(s){e=g(s,"SPAN",{class:!0});var a=C(e);t=O(a,"+"),n=O(a,l),a.forEach(p),this.h()},h(){b(e,"class","added svelte-tkeujr")},m(s,a){U(s,e,a),m(e,t),m(e,n)},p(s,a){a&64&&l!==(l=s[6].lines_added+"")&&pe(n,l)},d(s){s&&p(e)}}}function ce(o){let e,t,l=o[6].lines_removed+"",n;return{c(){e=k("span"),t=A("-"),n=A(l),this.h()},l(s){e=g(s,"SPAN",{class:!0});var a=C(e);t=O(a,"-"),n=O(a,l),a.forEach(p),this.h()},h(){b(e,"class","removed svelte-tkeujr")},m(s,a){U(s,e,a),m(e,t),m(e,n)},p(s,a){a&64&&l!==(l=s[6].lines_removed+"")&&pe(n,l)},d(s){s&&p(e)}}}function Me(o){let e,t,l,n,s,a,u,r,d;function c(h){o[19](h)}let y={language:"python",lines:10,dark_mode:!1,basic:!0,readonly:!1,placeholder:"Enter your code here...",wrap_lines:!0};o[5]!==void 0&&(y.value=o[5]),l=new Ie({props:y}),le.push(()=>Te(l,"value",c));function f(h,E){return h[1]?Pe:Ne}let v=f(o),w=v(o);return{c(){e=k("div"),t=k("div"),ve(l.$$.fragment),s=z(),a=k("button"),w.c(),this.h()},l(h){e=g(h,"DIV",{class:!0});var E=C(e);t=g(E,"DIV",{class:!0});var M=C(t);be(l.$$.fragment,M),M.forEach(p),s=L(E),a=g(E,"BUTTON",{class:!0});var V=C(a);w.l(V),V.forEach(p),E.forEach(p),this.h()},h(){b(t,"class","code-editor-container svelte-tkeujr"),b(a,"class","update-code-button svelte-tkeujr"),W(a,"updating",o[1]),b(e,"class","code-content svelte-tkeujr")},m(h,E){U(h,e,E),m(e,t),ke(l,t,null),m(e,s),m(e,a),w.m(a,null),u=!0,r||(d=R(a,"click",o[12]),r=!0)},p(h,E){const M={};!n&&E&32&&(n=!0,M.value=h[5],Be(()=>n=!1)),l.$set(M),v!==(v=f(h))&&(w.d(1),w=v(h),w&&(w.c(),w.m(a,null))),(!u||E&2)&&W(a,"updating",h[1])},i(h){u||(F(l.$$.fragment,h),u=!0)},o(h){X(l.$$.fragment,h),u=!1},d(h){h&&p(e),ge(l),w.d(),r=!1,d()}}}function Ve(o){let e,t,l,n=re(o[7]),s=[];for(let r=0;r<n.length;r+=1)s[r]=fe(ie(o,n,r));const a=r=>X(s[r],1,1,()=>{s[r]=null});let u=o[7].length===0&&he();return{c(){e=k("div");for(let r=0;r<s.length;r+=1)s[r].c();t=z(),u&&u.c(),this.h()},l(r){e=g(r,"DIV",{class:!0});var d=C(e);for(let c=0;c<s.length;c+=1)s[c].l(d);t=L(d),u&&u.l(d),d.forEach(p),this.h()},h(){b(e,"class","message-history svelte-tkeujr")},m(r,d){U(r,e,d);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(e,null);m(e,t),u&&u.m(e,null),o[18](e),l=!0},p(r,d){if(d&1152){n=re(r[7]);let c;for(c=0;c<n.length;c+=1){const y=ie(r,n,c);s[c]?(s[c].p(y,d),F(s[c],1)):(s[c]=fe(y),s[c].c(),F(s[c],1),s[c].m(e,t))}for(_e(),c=n.length;c<s.length;c+=1)a(c);me()}r[7].length===0?u||(u=he(),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(r){if(!l){for(let d=0;d<n.length;d+=1)F(s[d]);l=!0}},o(r){s=s.filter(Boolean);for(let d=0;d<s.length;d+=1)X(s[d]);l=!1},d(r){r&&p(e),De(s,r),u&&u.d(),o[18](null)}}}function Ne(o){let e;return{c(){e=A("Update Code")},l(t){e=O(t,"Update Code")},m(t,l){U(t,e,l)},d(t){t&&p(e)}}}function Pe(o){let e;return{c(){e=A("Updated!")},l(t){e=O(t,"Updated!")},m(t,l){U(t,e,l)},d(t){t&&p(e)}}}function de(o){let e,t="Undo",l,n;function s(){return o[17](o[28],o[30])}return{c(){e=k("button"),e.textContent=t,this.h()},l(a){e=g(a,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),se(e)!=="svelte-1hv8emy"&&(e.textContent=t),this.h()},h(){b(e,"class","undo-button svelte-tkeujr"),b(e,"title","Undo this change")},m(a,u){U(a,e,u),l||(n=R(e,"click",s),l=!0)},p(a,u){o=a},d(a){a&&p(e),l=!1,n()}}}function fe(o){let e,t,l,n,s,a;n=new Ue({props:{value:o[28].text,latex_delimiters:[],theme_mode:"system"}});let u=!o[28].isBot&&o[28].hash&&!o[28].isPending&&de(o);return{c(){e=k("div"),t=k("div"),l=k("span"),ve(n.$$.fragment),s=z(),u&&u.c(),this.h()},l(r){e=g(r,"DIV",{class:!0});var d=C(e);t=g(d,"DIV",{class:!0});var c=C(t);l=g(c,"SPAN",{class:!0});var y=C(l);be(n.$$.fragment,y),y.forEach(p),s=L(c),u&&u.l(c),c.forEach(p),d.forEach(p),this.h()},h(){b(l,"class","message-text svelte-tkeujr"),b(t,"class","message-content svelte-tkeujr"),b(e,"class","message-item svelte-tkeujr"),W(e,"bot-message",o[28].isBot),W(e,"user-message",!o[28].isBot)},m(r,d){U(r,e,d),m(e,t),m(t,l),ke(n,l,null),m(t,s),u&&u.m(t,null),a=!0},p(r,d){const c={};d&128&&(c.value=r[28].text),n.$set(c),!r[28].isBot&&r[28].hash&&!r[28].isPending?u?u.p(r,d):(u=de(r),u.c(),u.m(t,null)):u&&(u.d(1),u=null),(!a||d&128)&&W(e,"bot-message",r[28].isBot),(!a||d&128)&&W(e,"user-message",!r[28].isBot)},i(r){a||(F(n.$$.fragment,r),a=!0)},o(r){X(n.$$.fragment,r),a=!1},d(r){r&&p(e),ge(n),u&&u.d()}}}function he(o){let e,t="No messages yet";return{c(){e=k("div"),e.textContent=t,this.h()},l(l){e=g(l,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-1lmz9va"&&(e.textContent=t),this.h()},h(){b(e,"class","no-messages svelte-tkeujr")},m(l,n){U(l,e,n)},d(l){l&&p(e)}}}function Se(o){let e,t,l,n,s,a="Chat",u,r,d,c,y,f,v,w,h,E,M="Powered by: <code>gpt-oss</code>",V,B,G,D,K,H,N,J,Y,j=o[6]&&(o[6].lines_added>0||o[6].lines_removed>0)&&ae(o);const Z=[Ve,Me],P=[];function $(i,_){return i[0]==="chat"?0:i[0]==="code"?1:-1}return~(f=$(o))&&(v=P[f]=Z[f](o)),{c(){e=k("div"),t=k("button"),l=z(),n=k("div"),s=k("button"),s.textContent=a,u=z(),r=k("button"),d=A(`Code
			`),j&&j.c(),c=z(),y=k("div"),v&&v.c(),w=z(),h=k("div"),E=k("div"),E.innerHTML=M,V=z(),B=k("textarea"),G=z(),D=k("button"),K=A("Send"),this.h()},l(i){e=g(i,"DIV",{class:!0,style:!0});var _=C(e);t=g(_,"BUTTON",{class:!0,"aria-label":!0}),C(t).forEach(p),l=L(_),n=g(_,"DIV",{class:!0});var T=C(n);s=g(T,"BUTTON",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-1jfn66n"&&(s.textContent=a),u=L(T),r=g(T,"BUTTON",{class:!0});var q=C(r);d=O(q,`Code
			`),j&&j.l(q),q.forEach(p),T.forEach(p),c=L(_),y=g(_,"DIV",{class:!0});var Q=C(y);v&&v.l(Q),Q.forEach(p),w=L(_),h=g(_,"DIV",{class:!0});var I=C(h);E=g(I,"DIV",{class:!0,"data-svelte-h":!0}),se(E)!=="svelte-4qz8uo"&&(E.innerHTML=M),V=L(I),B=g(I,"TEXTAREA",{placeholder:!0,class:!0}),C(B).forEach(p),G=L(I),D=g(I,"BUTTON",{class:!0});var S=C(D);K=O(S,"Send"),S.forEach(p),I.forEach(p),_.forEach(p),this.h()},h(){b(t,"class","resize-handle svelte-tkeujr"),b(t,"aria-label","Resize sidebar"),b(s,"class","tab-button svelte-tkeujr"),W(s,"active",o[0]==="chat"),b(r,"class","tab-button svelte-tkeujr"),W(r,"active",o[0]==="code"),b(n,"class","tab-header svelte-tkeujr"),b(y,"class","tab-content svelte-tkeujr"),b(E,"class","powered-by svelte-tkeujr"),b(B,"placeholder","What can I add or change?"),b(B,"class","prompt-input svelte-tkeujr"),b(D,"class","submit-button svelte-tkeujr"),D.disabled=H=o[2].trim()==="",b(h,"class","input-section svelte-tkeujr"),b(e,"class","vibe-editor svelte-tkeujr"),ne(e,"width",o[3]+"px")},m(i,_){U(i,e,_),m(e,t),m(e,l),m(e,n),m(n,s),m(n,u),m(n,r),m(r,d),j&&j.m(r,null),m(e,c),m(e,y),~f&&P[f].m(y,null),m(e,w),m(e,h),m(h,E),m(h,V),m(h,B),oe(B,o[2]),m(h,G),m(h,D),m(D,K),o[22](e),N=!0,J||(Y=[R(t,"mousedown",o[11]),R(s,"click",o[15]),R(r,"click",o[16]),R(B,"keydown",o[20]),R(B,"input",o[21]),R(D,"click",o[9])],J=!0)},p(i,[_]){(!N||_&1)&&W(s,"active",i[0]==="chat"),i[6]&&(i[6].lines_added>0||i[6].lines_removed>0)?j?j.p(i,_):(j=ae(i),j.c(),j.m(r,null)):j&&(j.d(1),j=null),(!N||_&1)&&W(r,"active",i[0]==="code");let T=f;f=$(i),f===T?~f&&P[f].p(i,_):(v&&(_e(),X(P[T],1,1,()=>{P[T]=null}),me()),~f?(v=P[f],v?v.p(i,_):(v=P[f]=Z[f](i),v.c()),F(v,1),v.m(y,null)):v=null),_&4&&oe(B,i[2]),(!N||_&4&&H!==(H=i[2].trim()===""))&&(D.disabled=H),(!N||_&8)&&ne(e,"width",i[3]+"px")},i(i){N||(F(v),N=!0)},o(i){X(v),N=!1},d(i){i&&p(e),j&&j.d(),~f&&P[f].d(),o[22](null),J=!1,je(Y)}}}function ze(o,e,t){let{app:l}=e,{root:n}=e,s="",a=350,u=!1,r,d="chat",c="",y=null,f=[],v;const w=(i="smooth")=>{v&&v.scrollTo({top:v.scrollHeight,behavior:i})},h=async()=>{if(s.trim()==="")return;t(6,y=null);const i=f.length;t(7,f=[...f,{text:s,isBot:!1}]);const _=f.length;t(7,f=[...f,{text:"Working...",isBot:!0,isPending:!0}]),await te(),w();const T=s;t(2,s=""),l.post_data(`${n}/gradio_api/vibe-edit/`,{prompt:T}).then(async([Q,I])=>{if(I!==200)throw new Error(`Error: ${I}`);const S=Q;t(6,y=S.diff_stats),t(7,f=f.map((x,ee)=>(console.log(ee,i,S.hash),ee===i?{...x,hash:S.hash}:x))),t(7,f=f.map((x,ee)=>ee===_?{text:S.reasoning?S.reasoning:"Done.",isBot:!0,isPending:!1}:x)),await te(),w()}).catch(async Q=>{t(7,f=f.map((I,S)=>S===_?{text:"Error occurred.",isBot:!0,isPending:!1}:I)),await te(),w()})},E=async(i,_)=>{try{await l.post_data(`${n}/gradio_api/undo-vibe-edit/`,{hash:i}),t(6,y=null);const T=f[_];t(2,s=T.text),t(7,f=f.slice(0,_))}catch(T){console.error("Failed to undo:",T)}},M=i=>{i.preventDefault(),u=!0,document.addEventListener("mousemove",V),document.addEventListener("mouseup",B),document.body.style.cursor="col-resize",document.body.style.userSelect="none"},V=i=>{if(!u)return;const _=250,T=Math.min(800,window.innerWidth*.5),q=window.innerWidth-i.clientX;t(3,a=Math.max(_,Math.min(T,q))),window.dispatchEvent(new CustomEvent("vibeEditorResize",{detail:{width:a}}))},B=()=>{u=!1,document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",B),document.body.style.cursor="",document.body.style.userSelect=""},G=async()=>{try{const i=await fetch(`${n}/gradio_api/vibe-code/`,{method:"GET",headers:{"Content-Type":"application/json"}});if(i.ok){const _=await i.json();t(5,c=_.code)}}catch(i){console.error("Failed to fetch code:",i)}};let D=!1;const K=async()=>{try{await l.post_data(`${n}/gradio_api/vibe-code/`,{code:c}),t(1,D=!0),setTimeout(()=>{t(1,D=!1)},1e3)}catch(i){console.error("Failed to update code:",i)}};Ce(()=>()=>{document.removeEventListener("mousemove",V),document.removeEventListener("mouseup",B)});const H=()=>t(0,d="chat"),N=()=>t(0,d="code"),J=(i,_)=>E(i.hash||"",_);function Y(i){le[i?"unshift":"push"](()=>{v=i,t(8,v)})}function j(i){c=i,t(5,c)}const Z=i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),h())};function P(){s=this.value,t(2,s)}function $(i){le[i?"unshift":"push"](()=>{r=i,t(4,r)})}return o.$$set=i=>{"app"in i&&t(13,l=i.app),"root"in i&&t(14,n=i.root)},o.$$.update=()=>{o.$$.dirty&8192&&G(),o.$$.dirty&1&&d==="chat"&&te().then(()=>w("auto")),o.$$.dirty&2},[d,D,s,a,r,c,y,f,v,h,E,M,K,l,n,H,N,J,Y,j,Z,P,$]}class qe extends ye{constructor(e){super(),Ee(this,e,ze,Se,we,{app:13,root:14})}}export{qe as default};
//# sourceMappingURL=Index.BFjggwCJ.js.map
